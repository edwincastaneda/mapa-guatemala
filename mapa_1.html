<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>MAPA</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    </head>
    <body>
        <style>
            .background {
                fill: none;
                pointer-events: all;
            }

            #mapa_guatemala {
                fill: #aaa;
            }

            #mapa_guatemala path{
                stroke: #ccc;
                stroke-width: 1px;
            }


            #mapa_guatemala .active {
                fill: orange;
            }

        </style>
        <script type="text/javascript">

            function omitirAcentos(text) {
                var acentos = "ÃÀÁÄÂÈÉËÊÌÍÏÎÒÓÖÔÙÚÜÛãàáäâèéëêìíïîòóöôùúüûÑñÇç";
                var original = "AAAAAEEEEIIIIOOOOUUUUaaaaaeeeeiiiioooouuuunncc";
                for (var i = 0; i < acentos.length; i++) {
                    text = text.replace(acentos.charAt(i), original.charAt(i));
                }
                return text;
            }
            var width = 300,
                    height = 305,
                    centered;

            var svg = d3.select("body").append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .attr("style", "background:red;");

            var projection = d3.geo.mercator()
                    .center([-85.5, 14.444])
                    .scale(4000);

            var path = d3.geo.path()
                    .projection(projection);

            var g = svg.append("g");

            d3.json("deptos.json", function (error, guate) {
                if (error)
                    return console.error(error);

                var deptos = topojson.feature(guate, guate.objects.departamentos).features;



                g.append("g")
                        .attr("id", "mapa_guatemala")
                        .selectAll("path")
                        .data(deptos)
                        .enter().append("path")
                        .attr("d", path)
                        .attr("alt", function (d) {
                            return omitirAcentos(d.properties.NAME_1.toLowerCase());
                        })
                        .attr("id", function (d) {
                            return omitirAcentos(d.properties.NAME_1.replace(/ /g, '').toLowerCase());
                        })
                        .on("click", clicked);

            });


            function clicked(d) {

                var select = omitirAcentos(d.properties.NAME_1.replace(/ /g, '').toLowerCase());

                var x, y, k;
                if (d && centered !== d) {
                    var centroid = path.centroid(d);
                    x = centroid[0];
                    y = centroid[1];
                    k = 4;
                    centered = d;
                    if (select == "peten") {
                        k = 1.5;
                    }
                    if (select == "izabal") {
                        k = 2.6;
                    }
                    if (select == "huehuetenango") {
                        k = 3;
                    }

                    if (select == "altaverapaz" || select == "quiche") {
                        k = 3;
                    }
                } else {
                    x = width / 2;
                    y = height / 2;
                    k = 1;
                    centered = null;
                }



                g.selectAll("path")
                        .classed("active", centered && function (d) {
                            return d === centered;
                        });
                g.transition()
                        .duration(750)
                        .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
                        .style("stroke-width", 2 / k + "px");

            }


        </script>
    </body>
</html>  